{
  "title": "服务出现错误日志",
  "ruleGroup": "log_error_rate",
  "folderUID": "tracelogkit",
  "noDataState": "OK",
  "execErrState": "Error",
  "for": "0s",
  "uid": "log_error_rule_1",
  "condition": "B",
  "annotations": {
    "summary": "有服务出现 error 级别日志",
    "description": "过去 5 分钟内检测到错误日志，请查看 Log Error Rate 面板确认具体服务。"
  },
  "labels": { "severity": "critical" },
  "data": [
    {
      "refId": "A",
      "queryType": "",
      "relativeTimeRange": { "from": 300, "to": 0 },
      "datasourceUid": "tracelogkit-loki",
      "model": {
        "expr": "sum by (service) (count_over_time({project=~\".+\"} | json | level=\"error\" [5m]))",
        "hide": false,
        "intervalMs": 1000,
        "maxDataPoints": 43200,
        "refId": "A"
      }
    },
    {
      "refId": "B",
      "queryType": "",
      "relativeTimeRange": { "from": 0, "to": 0 },
      "datasourceUid": "-100",
      "model": {
        "conditions": [
          {
            "evaluator": { "params": [0], "type": "gt" },
            "operator": { "type": "and" },
            "query": { "params": ["A"] },
            "reducer": { "params": [], "type": "max" },
            "type": "query"
          }
        ],
        "datasource": { "type": "__expr__", "uid": "-100" },
        "hide": false,
        "intervalMs": 1000,
        "maxDataPoints": 43200,
        "refId": "B",
        "type": "classic_conditions"
      }
    }
  ]
}
